"""
프롬프트/도메인 SSOT: 템플릿 카탈로그 + 버전/플래그(A/B) 운영
"""

from typing import Dict


_CATALOG: Dict[str, Dict[str, Dict[str, Dict[str, str]]]] = {
    # domain -> variant(A/B/...) -> version -> templates
    "general": {
        "A": {
            "1": {
                "context": """다음은 질문에 대한 답변을 위한 참고 문서입니다:

{context}

사용자 질문: {question}

답변 작성 지침:
- 제공된 문서 내용을 바탕으로 답변하세요
- 문서에 명시된 구체적인 정보를 우선적으로 사용하세요
- **제공된 내용만 자연스럽게 재서술하세요. 새로운 정보·추정·추론은 절대 추가하지 마세요**
- **외부 지식, 일반 상식, 사례를 덧붙이지 마세요**
- 질문을 다시 쓰지 말고 바로 답변을 시작하세요
- 구체적인 수치나 데이터가 있으면 반드시 포함하세요
- **문서에 명시된 정확한 값, 범위, 설정값을 우선적으로 답변에 포함하세요**
- **단위를 정확히 표기하세요 (예: 10분, 100mg/L, 0.72 등)**
- **구체적인 기능이나 서비스에 대해서는 명확하게 설명하세요**
- **중국어나 일본어 등 외국어는 사용하지 마세요**
- 문서에 정보가 없거나 불확실한 경우에만 "제공된 문서에서 해당 정보를 찾을 수 없습니다"라고 답하세요
- 자연스럽고 친근한 대화체로 답변하되 존댓말을 사용하세요
- 답변은 3문장 이내로 간결하게 작성하세요

자연스럽고 존중하는 말투로 답변하세요:""",
                "no_context": """사용자 질문: {question}

답변 작성 지침:
- 질문을 다시 쓰지 말고 바로 답변을 시작하세요
- 구체적인 수치나 데이터가 있으면 반드시 포함하세요
- 간단명료하게 답변하세요
- 자연스럽고 친근한 대화체로 답변하되 존댓말을 사용하세요

자연스럽고 존중하는 말투로 답변하세요.""",
                "summary": """다음 문서들을 핵심 기준과 함께 3문장 이내로 요약하세요:

{context}

자연스럽고 존중하는 말투로 작성하세요:""",
            }
        }
    },
    "legal": {
        "A": {
            "1": {
                "context": """다음은 법률/규정 관련 문서입니다:

{context}

사용자 질문: {question}

답변 작성 지침:
- 반드시 위 문서 내용만 사용하세요
- **문서에 있는 내용만 자연스럽게 재서술하세요. 새로운 정보나 추론은 절대 금지**
- 문서에 없는 정보는 "제공된 문서에서 해당 정보를 찾을 수 없습니다"라고 답하세요
- 첫 문장: 질문에 대한 핵심을 간결하게 요약하세요
- 필요할 경우 bullet point(•)로 항목을 나열하세요
- 전체 답변은 3문장 이내로 제한하세요
- 법령/조항/근거를 명시하세요
- 불필요한 서론, 반복, 추측은 쓰지 마세요
- URL/경로는 한 번만, 백틱(`)으로 감싸세요
- "AI 비고:", "참고:", "주의:" 같은 레이블 사용 금지
- 이모지, 따옴표(") 사용 금지
- 질문을 다시 출력하지 마세요
- 빈 괄호 ( ) 사용 금지
- 정량적 데이터(시간, 수치, 범위)가 있으면 반드시 구체적으로 제시하세요
- 복잡한 설명 대신 핵심만 간단명료하게 답변하세요

중요: 질문을 절대 다시 쓰지 마세요. 바로 답변만 시작하세요.
따옴표(")를 절대 사용하지 마세요.
문서에 정확한 정보가 있으면 그대로 사용하세요.

자연스럽고 존중하는 말투로 답변하세요:""",
                "no_context": """사용자 질문: {question}

답변 작성 지침:
- 첫 문장에 핵심을 간단히 전달하세요
- 필요할 경우 bullet point(•)로 정리하세요
- 3문장 이내로 제한하세요
- 관련 법령과 근거 중심으로 답변하세요
- 불필요한 군더더기는 쓰지 마세요
- URL/경로는 한 번만, 백틱(`)으로 감싸세요
- "AI 비고:", "참고:", "주의:" 같은 레이블 사용 금지
- 이모지, 따옴표(") 사용 금지
- 질문을 다시 출력하지 마세요
- 빈 괄호 ( ) 사용 금지
- 정량적 데이터(시간, 수치, 범위)가 있으면 반드시 구체적으로 제시하세요
- 복잡한 설명 대신 핵심만 간단명료하게 답변하세요

중요: 질문을 절대 다시 쓰지 마세요. 바로 답변만 시작하세요.
따옴표(")를 절대 사용하지 마세요.

자연스럽고 존중하는 말투로 답변하세요.""",
                "summary": """다음 법률 문서들을 핵심 기준과 함께 3문장 이내로 요약하세요:

{context}

자연스럽고 존중하는 말투로 작성하세요:""",
            }
        }
    },
    "water": {
        "A": {
            "1": {
                "context": """다음은 정수처리/정수장 운영 관련 문서입니다:

{context}

사용자 질문: {question}

답변 작성 지침:
- 문서 내용만 사용하여 답변하세요
- **제공된 내용만 자연스럽게 재서술하세요. 새로운 정보·추정·추론은 절대 추가하지 마세요**
- **외부 지식, 일반 상식, 사례를 덧붙이지 마세요**
- 문서에 없는 정보는 "제공된 문서에서 해당 정보를 찾을 수 없습니다"라고 답하세요
- 질문을 다시 쓰지 말고 바로 답변을 시작하세요
- 구체적인 수치나 데이터가 있으면 반드시 포함하세요
- **정수처리 관련 정확한 수치, 범위, 설정값을 우선적으로 답변에 포함하세요**
- **단위를 정확히 표기하세요 (예: 10분, 100mg/L, 0.72, m³/h 등)**
- **구체적인 기능이나 서비스에 대해서는 명확하게 설명하세요**
- **중국어나 일본어 등 외국어는 사용하지 마세요**
- 답변은 3문장 이내로 간결하게 작성하세요

자연스럽고 존중하는 말투로 답변하세요:""",
                "no_context": """사용자 질문: {question}

답변 작성 지침:
- 질문을 다시 쓰지 말고 바로 답변을 시작하세요
- 구체적인 수치나 데이터가 있으면 반드시 포함하세요
- 간단명료하게 답변하세요
- 자연스럽고 친근한 대화체로 답변하되 존댓말을 사용하세요

자연스럽고 존중하는 말투로 답변하세요.""",
                "summary": """다음 정수처리 문서들을 핵심 기준과 함께 3문장 이내로 요약하세요:

{context}

자연스럽고 존중하는 말투로 작성하세요:""",
            }
        }
    },
}


def get_templates(domain: str, variant: str = "A", version: str = "1") -> Dict[str, str]:
    domain_key = (domain or "general").lower()
    if domain_key not in _CATALOG:
        domain_key = "general"
    var_map = _CATALOG[domain_key]
    if variant not in var_map:
        variant = "A"
    ver_map = var_map[variant]
    if version not in ver_map:
        version = next(iter(ver_map.keys()))
    return ver_map[version]


