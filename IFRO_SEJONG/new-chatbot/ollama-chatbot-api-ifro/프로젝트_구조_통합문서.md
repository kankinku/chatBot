# êµí†µ ë°ì´í„° ì±—ë´‡ í”„ë¡œì íŠ¸ êµ¬ì¡° í†µí•© ë¬¸ì„œ

## ğŸ“ ì „ì²´ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
êµí†µ ë°ì´í„° ì±—ë´‡/
â”œâ”€â”€ ğŸ“ data/                       # ë°ì´í„° ì €ì¥ì†Œ
â”‚   â”œâ”€â”€ ğŸ“ pdfs/                   # ì›ë³¸ PDF ë¬¸ì„œ
â”‚   â”‚   â””â”€â”€ êµí†µ ë°ì´í„° ê´€ë ¨ ë¬¸ì„œë“¤
â”‚   â”œâ”€â”€ ğŸ“ tests/                  # í…ŒìŠ¤íŠ¸ ë°ì´í„°
â”‚   â”‚   â””â”€â”€ qa.json                # ì§ˆë¬¸-ë‹µë³€ í…ŒìŠ¤íŠ¸ì…‹
â”‚   â”œâ”€â”€ ğŸ“„ corpus_v1.jsonl         # ë©”ì¸ ì½”í¼ìŠ¤ (PDF ì¶”ì¶œ ê²°ê³¼)
â”‚   â”œâ”€â”€ ğŸ“„ corpus_v1.jsonl.bak     # ì½”í¼ìŠ¤ ë°±ì—…
â”‚   â”œâ”€â”€ ğŸ“„ corpus_old.jsonl        # ì´ì „ ë²„ì „ ì½”í¼ìŠ¤
â”‚   â”œâ”€â”€ ğŸ“„ corpus.jsonl            # ìµœì¢… ì²˜ë¦¬ëœ ì½”í¼ìŠ¤
â”‚   â”œâ”€â”€ ğŸ“„ corpus.txt              # í…ìŠ¤íŠ¸ ë³€í™˜ëœ ì½”í¼ìŠ¤
â”‚   â”œâ”€â”€ ğŸ“„ corpus.manifest.json    # PDF ë©”íƒ€ë°ì´í„°
â”‚   â””â”€â”€ ğŸ“„ domain_dictionary.json  # êµí†µ ë°ì´í„° ë„ë©”ì¸ ì‚¬ì „
â”‚
â”œâ”€â”€ ğŸ“ scripts/                    # ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ ğŸ”§ build_corpus_from_pdfs.py    # PDF â†’ ì½”í¼ìŠ¤ ë³€í™˜
â”‚   â”œâ”€â”€ ğŸ”§ build_vector_index.py       # ì½”í¼ìŠ¤ â†’ ë²¡í„° ì¸ë±ìŠ¤ êµ¬ì¶•
â”‚   â”œâ”€â”€ ğŸ”§ convert_corpus_to_txt.py    # JSONL â†’ TXT ë³€í™˜
â”‚   â”œâ”€â”€ ğŸš€ autorun.py                  # ìë™ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ ğŸš€ manual_cli.py               # ìˆ˜ë™ CLI ì¸í„°í˜ì´ìŠ¤
â”‚   â””â”€â”€ ğŸš€ run_qa_benchmark.py         # QA ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸
â”‚
â”œâ”€â”€ ğŸ“ src/unifiedpdf/             # í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
â”‚   â”œâ”€â”€ ğŸ—ï¸ __init__.py            # íŒ¨í‚¤ì§€ ì´ˆê¸°í™”
â”‚   â”œâ”€â”€ ğŸ—ï¸ types.py               # ë°ì´í„° íƒ€ì… ì •ì˜ (ê¸°ë°˜)
â”‚   â”œâ”€â”€ ğŸ—ï¸ config.py              # ì„¤ì • ê´€ë¦¬ (ê¸°ë°˜)
â”‚   â”œâ”€â”€ ğŸ—ï¸ utils.py                # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ (ê¸°ë°˜)
â”‚   â”œâ”€â”€ ğŸ—ï¸ timeouts.py            # íƒ€ì„ì•„ì›ƒ ê´€ë¦¬ (ê¸°ë°˜)
â”‚   â”œâ”€â”€ ğŸ—ï¸ measurements.py        # ì¸¡ì • ë„êµ¬ (ê¸°ë°˜)
â”‚   â”œâ”€â”€ ğŸ” analyzer.py            # ì§ˆë¬¸ ë¶„ì„ (1ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ” embedding.py           # ì„ë² ë”© ì²˜ë¦¬ (1ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ” vector_store.py        # ë²¡í„° ì €ì¥ì†Œ (1ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ” retriever.py           # ê²€ìƒ‰ ì—”ì§„ (2ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ” merger.py              # ë³‘í•© ë° ì¤‘ë³µ ì œê±° (3ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ” filtering.py           # í•„í„°ë§ ë° êµì • (4ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ” reranker.py            # ë¦¬ë­í‚¹ (5ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ” context.py             # ì»¨í…ìŠ¤íŠ¸ êµ¬ì„± (6ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ¤– guardrail.py           # ê°€ë“œë ˆì¼ ê²€ì‚¬ (7ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ¤– llm.py                 # LLM ì¸í„°í˜ì´ìŠ¤ (8ë‹¨ê³„)
â”‚   â”œâ”€â”€ ğŸ¯ facade.py              # ë©”ì¸ íŒŒì´í”„ë¼ì¸ (í†µí•©)
â”‚   â”œâ”€â”€ ğŸ“„ pdf_processor.py       # PDF ì²˜ë¦¬ (ì „ì²˜ë¦¬)
â”‚   â”œâ”€â”€ ğŸ“„ ocr_corrector.py       # OCR ë³´ì • (ì „ì²˜ë¦¬)
â”‚   â”œâ”€â”€ ğŸ“„ domain_dictionary.py   # ë„ë©”ì¸ ì‚¬ì „ (ì „ì²˜ë¦¬)
â”‚   â”œâ”€â”€ ğŸ“Š metrics.py             # ì„±ëŠ¥ ë©”íŠ¸ë¦­ (í›„ì²˜ë¦¬)
â”‚   â””â”€â”€ ğŸ“ __pycache__/           # Python ìºì‹œ
â”‚
â”œâ”€â”€ ğŸ“ vector_store/               # ë²¡í„° ì €ì¥ì†Œ
â”‚   â”œâ”€â”€ ğŸ“„ index.faiss            # FAISS ë²¡í„° ì¸ë±ìŠ¤
â”‚   â”œâ”€â”€ ğŸ“„ mapping.json           # ì²­í¬ ID ë§¤í•‘
â”‚   â””â”€â”€ ğŸ“„ meta.json              # ë²¡í„° ë©”íƒ€ë°ì´í„°
â”‚
â”œâ”€â”€ ğŸ“ out/                        # ê²°ê³¼ ì¶œë ¥
â”‚   â”œâ”€â”€ ğŸ“„ report.json            # ìƒì„¸ ì„±ëŠ¥ ë¦¬í¬íŠ¸
â”‚   â”œâ”€â”€ ğŸ“„ report_simple.json     # ê°„ë‹¨ ì„±ëŠ¥ ë¦¬í¬íŠ¸
â”‚   â””â”€â”€ ğŸ“„ report.csv             # CSV í˜•íƒœ ë¦¬í¬íŠ¸
â”‚
â”œâ”€â”€ ğŸ“ server/                     # ì›¹ ì„œë²„
â”‚   â””â”€â”€ ğŸ“„ app.py                 # Flask ì›¹ ì„œë²„ ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚
â”œâ”€â”€ ğŸ“ logs/                       # ë¡œê·¸ íŒŒì¼
â”‚   â””â”€â”€ ğŸ“„ llm_errors.log         # LLM ì˜¤ë¥˜ ë¡œê·¸
â”‚
â”œâ”€â”€ ğŸ“„ requirements.txt            # Python ì˜ì¡´ì„±
â”œâ”€â”€ ğŸ“„ Dockerfile                  # Docker ì„¤ì •
â”œâ”€â”€ ğŸ“„ docker-compose.yml          # Docker Compose ì„¤ì •
â”œâ”€â”€ ğŸ“„ README.md                   # í”„ë¡œì íŠ¸ ì„¤ëª…
â”œâ”€â”€ ğŸ“„ êµí†µë°ì´í„°_ì±—ë´‡_ê¸°ìˆ ë³´ê³ ì„œ.md    # ê¸°ìˆ  ë¬¸ì„œ
â””â”€â”€ ğŸ“„ íŠœí† ë¦¬ì–¼.md                 # ì‚¬ìš© ê°€ì´ë“œ
```

## ğŸ”„ ë°ì´í„° íë¦„ (Data Flow)

```
PDF ë¬¸ì„œ â†’ ì½”í¼ìŠ¤ ìƒì„± â†’ ë²¡í„° ì¸ë±ìŠ¤ â†’ ê²€ìƒ‰ â†’ ë‹µë³€ ìƒì„±
    â†“           â†“            â†“         â†“        â†“
data/pdfs/ â†’ corpus.jsonl â†’ vector_store/ â†’ ê²€ìƒ‰ê²°ê³¼ â†’ ìµœì¢…ë‹µë³€
```

## ğŸš€ ì‹¤í–‰ íë¦„ (Execution Flow)

```
1. PDF ì²˜ë¦¬: build_corpus_from_pdfs.py
2. ì¸ë±ìŠ¤ êµ¬ì¶•: build_vector_index.py
3. ì‹œìŠ¤í…œ ì‹¤í–‰: autorun.py / manual_cli.py
4. ë²¤ì¹˜ë§ˆí¬: run_qa_benchmark.py
5. ì›¹ ì„œë²„: server/app.py
```

## ğŸ“Š src/unifiedpdf ëª¨ë“ˆ ì˜ì¡´ì„±

### í•µì‹¬ íŒŒì´í”„ë¼ì¸
```
facade.py (ë©”ì¸ íŒŒì´í”„ë¼ì¸)
â”œâ”€â”€ analyzer.py (ì§ˆë¬¸ ë¶„ì„)
â”œâ”€â”€ retriever.py (ê²€ìƒ‰)
â”‚   â”œâ”€â”€ vector_store.py
â”‚   â””â”€â”€ embedding.py
â”œâ”€â”€ merger.py (ë³‘í•©)
â”œâ”€â”€ filtering.py (í•„í„°ë§)
â”œâ”€â”€ reranker.py (ë¦¬ë­í‚¹)
â”œâ”€â”€ context.py (ì»¨í…ìŠ¤íŠ¸)
â”œâ”€â”€ guardrail.py (ê°€ë“œë ˆì¼)
â””â”€â”€ llm.py (ë‹µë³€ ìƒì„±)
```

### ê¸°ë°˜ ëª¨ë“ˆ
```
types.py (ë°ì´í„° êµ¬ì¡°)
config.py (ì„¤ì •)
utils.py (ìœ í‹¸ë¦¬í‹°)
timeouts.py (íƒ€ì„ì•„ì›ƒ)
measurements.py (ì¸¡ì •)
```

## ğŸ”— ê²½ë¡œ ì°¸ì¡° í˜„í™©

### âœ… ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ëœ ê²½ë¡œë“¤:

**data/ í´ë” ì°¸ì¡°:**
- `src/unifiedpdf/config.py`: `"data/domain_dictionary.json"` (êµí†µ ë°ì´í„° ë„ë©”ì¸ ì‚¬ì „)
- `scripts/build_corpus_from_pdfs.py`: `"data/corpus_v1.jsonl"`
- `scripts/autorun.py`: `"data/pdfs"`, `"data/tests/qa.json"`, `"data/corpus_v1.jsonl"`
- `scripts/build_vector_index.py`: `"data/corpus_v1.jsonl"`
- `scripts/run_qa_benchmark.py`: `"data/tests/qa.json"`, `"data/corpus_v1.jsonl"`
- `scripts/convert_corpus_to_txt.py`: `"data/corpus_v1.jsonl"`, `"data/corpus.txt"`
- `scripts/manual_cli.py`: `"data/corpus_v1.jsonl"`

**scripts/ í´ë” ì°¸ì¡°:**
- `scripts/autorun.py`: ë‹¤ë¥¸ scripts íŒŒì¼ë“¤ ì°¸ì¡°

**vector_store/ í´ë” ì°¸ì¡°:**
- `src/unifiedpdf/config.py`: `"vector_store"` (ê¸°ë³¸ê°’)

**out/ í´ë” ì°¸ì¡°:**
- `scripts/run_qa_benchmark.py`: ê²°ê³¼ ì¶œë ¥ ê²½ë¡œ

## ğŸ¯ ê¸°ëŠ¥ë³„ ë¶„ë¥˜

### ğŸ“„ ë°ì´í„° ê´€ë¦¬
- **data/**: ì›ë³¸ ë° ì²˜ë¦¬ëœ ë°ì´í„°
  - `pdfs/`: êµí†µ ë°ì´í„° ê´€ë ¨ PDF ì›ë³¸ ë¬¸ì„œ
  - `tests/`: í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹
  - `corpus_*.jsonl`: ì²˜ë¦¬ëœ ì½”í¼ìŠ¤
  - `domain_dictionary.json`: êµí†µ ë°ì´í„° ë„ë©”ì¸ ì‚¬ì „
- **vector_store/**: ë²¡í„° ì¸ë±ìŠ¤
- **out/**: ê²°ê³¼ ë° ë¦¬í¬íŠ¸

### ğŸ”§ ì²˜ë¦¬ ë„êµ¬
- **scripts/**: ì‹¤í–‰ ë° ë³€í™˜ ìŠ¤í¬ë¦½íŠ¸
  - ë°ì´í„° ì²˜ë¦¬: `build_corpus_from_pdfs.py`, `build_vector_index.py`, `convert_corpus_to_txt.py`
  - ì‹¤í–‰ ë° í…ŒìŠ¤íŠ¸: `autorun.py`, `manual_cli.py`, `run_qa_benchmark.py`
- **src/unifiedpdf/**: í•µì‹¬ ì²˜ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
  - ê¸°ë°˜ ëª¨ë“ˆ: `types.py`, `config.py`, `utils.py`, `timeouts.py`, `measurements.py`
  - ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸: `analyzer.py` â†’ `retriever.py` â†’ `merger.py` â†’ `filtering.py` â†’ `reranker.py` â†’ `context.py` â†’ `guardrail.py` â†’ `llm.py`
  - í†µí•© ê´€ë¦¬: `facade.py`
  - ì „ì²˜ë¦¬: `pdf_processor.py`, `ocr_corrector.py`, `domain_dictionary.py`
  - í›„ì²˜ë¦¬: `metrics.py`

### ğŸŒ ì„œë¹„ìŠ¤
- **server/**: ì›¹ ì„œë²„
- **logs/**: ë¡œê·¸ ê´€ë¦¬

### ğŸ“š ë¬¸ì„œ
- **README.md**: í”„ë¡œì íŠ¸ ê°œìš”
- **êµí†µë°ì´í„°_ì±—ë´‡_ê¸°ìˆ ë³´ê³ ì„œ.md**: ê¸°ìˆ  ë¬¸ì„œ
- **íŠœí† ë¦¬ì–¼.md**: ì‚¬ìš© ê°€ì´ë“œ

## âœ… ê²°ë¡ 

**ì „ì²´ í”„ë¡œì íŠ¸ êµ¬ì¡°ê°€ ë§¤ìš° ì˜ ì •ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤:**

1. **ëª…í™•í•œ í´ë” ë¶„ë¦¬**: ê¸°ëŠ¥ë³„ë¡œ í´ë”ê°€ ì˜ êµ¬ë¶„ë¨
2. **ì ì ˆí•œ ì˜ì¡´ì„± ê´€ë¦¬**: ëª¨ë“ˆ ê°„ ì˜ì¡´ì„±ì´ ëª…í™•í•¨
3. **ì˜¬ë°”ë¥¸ ê²½ë¡œ ì„¤ì •**: ëª¨ë“  ê²½ë¡œ ì°¸ì¡°ê°€ ì •í™•í•¨
4. **í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°**: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ê°€ ìš©ì´í•¨
5. **ìœ ì§€ë³´ìˆ˜ì„±**: ì½”ë“œ êµ¬ì¡°ê°€ ì´í•´í•˜ê¸° ì‰¬ì›€

**ì¶”ê°€ ì‘ì—…ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.** í˜„ì¬ êµ¬ì¡°ê°€ ì´ë¯¸ ìµœì í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
