"""
정수장 도메인 특화 사전
OCR 후교정을 위한 전문 용어 및 수치 정보
"""

# 정수장 전문 용어 사전
WATER_TREATMENT_DICTIONARY = """
정수장 전문 용어 사전:

【응집제 및 화학약품】
- 응집제: 폴리염화알루미늄(PAC), 황산알루미늄, 염화철, 황산철
- 소독제: 염소, 차아염소산나트륨, 오존, 자외선
- pH조절제: 소석회, 탄산나트륨, 수산화나트륨
- 응집보조제: 폴리머, 활성실리카

【처리시설 및 공정】
- 취수시설: 취수정, 취수펌프장, 취수관로
- 침전시설: 1차침전지, 2차침전지, 고속침전지, 라멜라침전지
- 여과시설: 모래여과지, 활성탄여과지, 막여과, 역세척
- 소독시설: 염소주입시설, 오존발생기, 자외선살균기
- 고도처리: 생물활성탄, 막여과, 역삼투, 전기투석

【수질지표 및 측정항목】
- 물리적지표: 탁도(NTU), 색도, 냄새, 맛, 온도
- 화학적지표: pH, 잔류염소, 용존산소(DO), 생물학적산소요구량(BOD)
- 화학적산소요구량(COD), 총유기탄소(TOC), 총질소(TN), 총인(TP)
- 미생물지표: 대장균군(CFU), 일반세균, 클로리드, 설파이트

【처리공정 및 운영】
- 응집공정: 급속혼화, 완속혼화, 응집반응
- 침전공정: 중력침전, 부상침전, 고속침전
- 여과공정: 모래여과, 활성탄여과, 막여과, 역세척
- 소독공정: 염소소독, 오존소독, 자외선소독
- 고도처리: 생물처리, 물리화학처리, 막분리

【시설물 및 장비】
- 펌프: 취수펌프, 송수펌프, 배수펌프, 역세척펌프
- 밸브: 게이트밸브, 체크밸브, 볼밸브, 나비밸브
- 계측기: 유량계, 압력계, 레벨계, pH미터, 탁도계
- 제어장치: PLC, SCADA, 자동제어시스템

【단위 및 수치】
- 유량: m³/d, L/s, m³/h, m³/min
- 농도: mg/L, ppm, ppb, μg/L, ng/L
- 압력: kgf/cm², bar, MPa, kPa
- 온도: ℃, °C, K
- pH: 0-14 범위
- 탁도: NTU, JTU, FTU
- 색도: TCU, PCU, Pt-Co

【정수장 시스템 및 플랫폼】
- AI 플랫폼: 자율운영, 대시보드, SCADA 연동
- 로그인:  관리자 계정, 사용자 인증
- 운영모드: AI 추천, AI 분석, 수동운전, 부분모드
- 대시보드: 상단영역, 좌측사이드바, 중앙콘텐츠, 우측메뉴
- 공정제어: 착수, 약품, 혼화응집, 침전, 여과, 소독
- 알람관리: 제어알람, 운전모드변경, 비상대응

【AI 모델 및 알고리즘】
- 예측모델: LSTM, GRU, N-beats, XGB, GBR
- 성능지표: R², MAE, MSE, RMSE, 정확도
- 입력변수: 원수탁도, pH, 온도, 전기전도도, 알칼리도
- 제어설정: 임계치설정, 채터링방지, 스텝설정, 군집유량분배

【PMS 및 진단시스템】
- 펌프진단: 부하/반부하, 총진동량, 베어링결함, 임펠러결함
- 모터진단: 회전자결함, 권선온도, 축정렬불량, 질량불평형
- 결함유형: 캐비테이션발생, 베어링온도, 진동분석
- 진단기능: 자율진단, 정밀진단, 통계이력, 알람관리

【운영상태 및 조건】
- 정상운영: 설계용량, 최대용량, 최소용량
- 비상상황: 정전, 장비고장, 수질이상, 천재지변
- 유지보수: 정기점검, 예방보전, 수리보수, 교체
- 안전관리: 작업안전, 화학약품안전, 전기안전

【법규 및 기준】
- 수질기준: 먹는물수질기준, 하수처리수질기준
- 운영기준: 정수장운영기준, 안전관리기준
- 환경기준: 환경정책기본법, 수질환경보전법
"""

# 정수장 특화 단위 변환 규칙
WATER_TREATMENT_UNIT_CONVERSIONS = {
    # 유량 변환
    "m³/d": {"l/s": 1/86.4, "m³/h": 1/24, "m³/min": 1/1440},
    "l/s": {"m³/d": 86.4, "m³/h": 3.6, "m³/min": 0.06},
    "m³/h": {"m³/d": 24, "l/s": 1/3.6, "m³/min": 1/60},
    
    # 농도 변환 (물의 경우 근사치)
    "mg/l": {"ppm": 1.0, "ppb": 1000, "μg/l": 1000},
    "ppm": {"mg/l": 1.0, "ppb": 1000, "μg/l": 1000},
    "ppb": {"mg/l": 0.001, "ppm": 0.001, "μg/l": 1.0},
    "μg/l": {"mg/l": 0.001, "ppm": 0.001, "ppb": 1.0},
    
    # 압력 변환
    "kgf/cm²": {"bar": 0.980665, "mpa": 0.0980665, "kpa": 98.0665},
    "bar": {"kgf/cm²": 1.01972, "mpa": 0.1, "kpa": 100},
    "mpa": {"kgf/cm²": 10.1972, "bar": 10, "kpa": 1000},
}

# 정수장 특화 수치 범위 (정상/이상 판단 기준)
WATER_TREATMENT_RANGES = {
    "ph": {"정상": (6.5, 8.5), "이상": (0, 6.5), "이상": (8.5, 14)},
    "탁도_ntu": {"정상": (0, 0.5), "주의": (0.5, 1.0), "이상": (1.0, 100)},
    "잔류염소_mg_l": {"정상": (0.1, 0.4), "부족": (0, 0.1), "과다": (0.4, 5.0)},
    "용존산소_mg_l": {"정상": (5, 10), "부족": (0, 5), "과다": (10, 20)},
    "온도_℃": {"정상": (5, 25), "저온": (0, 5), "고온": (25, 40)},
    "압력_kgf_cm²": {"정상": (2, 6), "저압": (0, 2), "고압": (6, 15)},
}

# 정수장 특화 OCR 오류 패턴
WATER_TREATMENT_OCR_PATTERNS = {
    # 자주 오인식되는 패턴
    "rn": "m",  # rn → m
    "cl": "d",  # cl → d  
    "0": "O",   # 0 → O
    "O": "0",   # O → 0
    "l": "1",   # l → 1
    "1": "l",   # 1 → l
    "S": "5",   # S → 5
    "5": "S",   # 5 → S
    "B": "8",   # B → 8
    "8": "B",   # 8 → B
    
    # 정수장 특화 오류
    "mg|L": "mg/L",
    "m3/d": "m³/d",
    "m3/h": "m³/h",
    "pH": "pH",
    "NTU": "NTU",
    "DO": "DO",
    "BOD": "BOD",
    "COD": "COD",
    "TOC": "TOC",
    "TN": "TN",
    "TP": "TP",
}

# 정수장 질문 유형별 키워드
WATER_TREATMENT_QUESTION_TYPES = {
    "수치_질문": [
        "몇", "얼마", "수치", "농도", "유량", "용량", "효율", "제거율", 
        "처리량", "탁도", "pH", "압력", "온도", "높이", "깊이", "속도"
    ],
    "정의_질문": [
        "정의", "무엇", "란", "의미", "개념", "설명", "이해"
    ],
    "절차_질문": [
        "방법", "절차", "순서", "어떻게", "과정", "단계", "처리", "운영"
    ],
    "비교_질문": [
        "비교", "vs", "더", "높", "낮", "차이", "우수", "열등", "장단점"
    ],
    "문제_질문": [
        "문제", "고장", "이상", "오류", "장애", "해결", "대책", "원인"
    ]
}

def get_domain_dictionary() -> str:
    """정수장 도메인 사전 반환"""
    return WATER_TREATMENT_DICTIONARY

def get_unit_conversions() -> dict:
    """단위 변환 규칙 반환"""
    return WATER_TREATMENT_UNIT_CONVERSIONS

def get_value_ranges() -> dict:
    """수치 범위 기준 반환"""
    return WATER_TREATMENT_RANGES

def get_ocr_patterns() -> dict:
    """OCR 오류 패턴 반환"""
    return WATER_TREATMENT_OCR_PATTERNS

def get_question_keywords() -> dict:
    """질문 유형별 키워드 반환"""
    return WATER_TREATMENT_QUESTION_TYPES

def is_water_treatment_term(term: str) -> bool:
    """정수장 관련 용어인지 판단"""
    dictionary = get_domain_dictionary().lower()
    return term.lower() in dictionary

def get_similar_terms(term: str) -> list:
    """유사한 정수장 용어 찾기"""
    dictionary = get_domain_dictionary().lower()
    similar = []
    
    for line in dictionary.split('\n'):
        if term.lower() in line.lower():
            similar.append(line.strip())
    
    return similar[:5]  # 최대 5개 반환
